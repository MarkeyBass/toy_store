<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
  <title>Usrers API</title>
</head>

<body>
  <div class="container">
    <h1 class="display-5 mb-4 mt-4">Mark Toys USERS</h1>
    <div class="d-flex">
      <button id="add-user" class="btn btn-success me-4 mt-4">Add User</button>
      <button id="get-all-users" class="btn btn-success me-4 mt-4">Show All Users</button>
      <a href="./products.html" class="btn btn-warning me-4 mt-4">Go To Products API</a>
    </div>

    <div id="output" class="mt-4"></div>
    <form id='form' style="display:none;" class="mt-4">
      <div class="form-group mb-4">
        <input type="number" class="form-control" id="id" placeholder="id">
      </div>
      <div class="form-group mb-4">
        <input type="text" class="form-control" id="name" placeholder="Full Name"></input>
      </div>
      <div class="form-group mb-4">
        <input type="number" class="form-control" id="phone" placeholder="Phone"></input>
      </div>
      <div class="form-group mb-4">
        <input type="email" class="form-control" id="email" placeholder="Email"></input>
      </div>
      <div class="form-group mb-4">
        <input type="text" class="form-control" id="role" placeholder="Role"></input>
      </div>
      <input type="submit" class="btn btn-primary mb-4" value="submit">
    </form>
  </div>

  <script>
    const form = document.getElementById('form');
    const output = document.getElementById('output');

    document.getElementById('add-user').addEventListener('click', showForm);
    document.getElementById('get-all-users').addEventListener('click', getUsers);
    form.addEventListener('submit', addUser)

    function showForm() {
      form.style.display = 'block';
      output.innerHTML = '';
    }

    function getUsers() {
      form.style.display = 'none'
      fetch('http://localhost:5000/users/all-users')
        .then((res) => res.json())
        .then((data) => {
          console.log(data);
          output.innerHTML = "<h3>List Of Users</h3>"
          data.forEach((user) => {
            // console.log(user.name);
            output.innerHTML += `
              <div class="card card-body mb-3">
                <h4>name: ${user.name}</h4>
                <p>id: ${user.id}</p>
                <p>role: ${role.role}</p>
                <p>email: ${user.email}</p>
                <p>phone: ${user.phone}</p>
              </div>
            `
          });
        })
        .catch((err) => console.log(err));
    }

    function addUser(e) {
      let reqData = {
        id: form.id.value,
        name: form.name.value,
        phone: form.phone.value,
        email: form.email.value,
        role: form.role.value,
      }

      fetch('http://localhost:5000/users/add-user', {
        method: "POST",
        headers: {
          'Accept': 'application/json, text/plain, */*',
          'Content-Type': 'application/json;charset=utf-8'
        },
        body: JSON.stringify(reqData)
      })
        .then((res) => res.json())
        .then((resData) => console.log(resData))
        .catch((err) => console.log(err));

      output.innerHTML += `
        <h4>User was edded</h4>
        <div class="card card-body mb-3">
          <p>name: ${reqData.name}</p>
          <p>id: ${reqData.id}</p>
          <p>role: ${reqData.role}</p>
          <p>email: ${reqData.email}</p>
          <p>phone: ${reqData.phone}</p>
        </div>
      `
      form.style.display = 'none';
      form.id.value = ''; form.name.value = ''; form.phone.value = '';
      form.email.value = ''; form.role.value = '';

      e.preventDefault();
    }

  </script>

</body>

</html>